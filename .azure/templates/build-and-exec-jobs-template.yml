parameters:
  execJobs:
    - igName: fhir-tools-ig-exec
      vmImage: ubuntu-latest
      jdkVersion: 1.17
      gitRepo: https://github.com/FHIR/fhir-tools-ig.git
    - igName: fhir-tools-ig-exec
      vmImage: windows-latest
      jdkVersion: 1.11
      gitRepo: https://github.com/FHIR/fhir-tools-ig.git
    - igName: fhir-tools-ig-exec
      vmImage: windows-latest
      jdkVersion: 1.17
      gitRepo: https://github.com/FHIR/fhir-tools-ig.git
    - igName: fhir-tools-ig-exec
      vmImage: macos-latest
      jdkVersion: 1.11
      gitRepo: https://github.com/FHIR/fhir-tools-ig.git
    - igName: ACME-FSH-IG-Example
      vmImage: ubuntu-latest
      jdkVersion: 1.11
      gitRepo: https://github.com/FirelyTeam/ACME-FSH-IG-Example.git
    - igName: ACME-FSH-IG-Example
      vmImage: windows-latest
      jdkVersion: 1.11
      gitRepo: https://github.com/FirelyTeam/ACME-FSH-IG-Example.git
    - igName: ACME-FSH-IG-Example
      vmImage: macos-latest
      jdkVersion: 1.11
      gitRepo: https://github.com/FirelyTeam/ACME-FSH-IG-Example.git

jobs:
  - ${{ each execJob in parameters.execJobs }}:
      - job:

        displayName: Run publisher on ${{execJob.igName}} on ${{execJob.vmImage}} and Java ${{execJob.jdkVersion}}
        
        pool:
          vmImage: ${{execJob.vmImage}}

        variables:
          currentImage: ${{execJob.vmImage}}
          VERSION:
          JAVA_TOOL_OPTIONS: ${{execJob.javaToolOptions}}

        steps:
          - template: ./build-and-exec-steps-template.yml
            parameters:
                igName: ${{execJob.igName}}
                gitRepo: ${{execJob.gitRepo}}
                jdkVersion: ${{execJob.jdkVersion}}
                javaToolOptions: ${{execJob.javaToolOptions}}